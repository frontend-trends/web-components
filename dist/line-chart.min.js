"use strict";function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function _toConsumableArray(t){return _arrayWithoutHoles(t)||_iterableToArray(t)||_unsupportedIterableToArray(t)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(t,n){if(t){if("string"==typeof t)return _arrayLikeToArray(t,n);var e=Object.prototype.toString.call(t).slice(8,-1);return"Object"===e&&t.constructor&&(e=t.constructor.name),"Map"===e||"Set"===e?Array.from(t):"Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e)?_arrayLikeToArray(t,n):void 0}}function _iterableToArray(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}function _arrayWithoutHoles(t){if(Array.isArray(t))return _arrayLikeToArray(t)}function _arrayLikeToArray(t,n){(null==n||n>t.length)&&(n=t.length);for(var e=0,r=new Array(n);e<n;e++)r[e]=t[e];return r}function _classCallCheck(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,n){for(var e=0;e<n.length;e++){var r=n[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function _createClass(t,n,e){return n&&_defineProperties(t.prototype,n),e&&_defineProperties(t,e),t}function _inherits(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(n&&n.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),n&&_setPrototypeOf(t,n)}function _createSuper(e){var r=_isNativeReflectConstruct();return function(){var t,n=_getPrototypeOf(e);return _possibleConstructorReturn(this,r?(t=_getPrototypeOf(this).constructor,Reflect.construct(n,arguments,t)):n.apply(this,arguments))}}function _possibleConstructorReturn(t,n){return!n||"object"!==_typeof(n)&&"function"!=typeof n?_assertThisInitialized(t):n}function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _wrapNativeSuper(t){var e="function"==typeof Map?new Map:void 0;return(_wrapNativeSuper=function(t){if(null===t||!_isNativeFunction(t))return t;if("function"!=typeof t)throw new TypeError("Super expression must either be null or a function");if(void 0!==e){if(e.has(t))return e.get(t);e.set(t,n)}function n(){return _construct(t,arguments,_getPrototypeOf(this).constructor)}return n.prototype=Object.create(t.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),_setPrototypeOf(n,t)})(t)}function _construct(t,n,e){return(_construct=_isNativeReflectConstruct()?Reflect.construct:function(t,n,e){var r=[null];r.push.apply(r,n);var o=new(Function.bind.apply(t,r));return e&&_setPrototypeOf(o,e.prototype),o}).apply(null,arguments)}function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(t){return!1}}function _isNativeFunction(t){return-1!==Function.toString.call(t).indexOf("[native code]")}function _setPrototypeOf(t,n){return(_setPrototypeOf=Object.setPrototypeOf||function(t,n){return t.__proto__=n,t})(t,n)}function _getPrototypeOf(t){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var LineChart=function(){_inherits(n,_wrapNativeSuper(HTMLElement));var t=_createSuper(n);function n(){return _classCallCheck(this,n),t.apply(this,arguments)}return _createClass(n,[{key:"connectedCallback",value:function(){var n=this,e=this.getAttributes(this),r=this.attachShadow({mode:"open"});e.source?fetch(e.source).then(function(t){return t.json()}).then(function(t){e.data=t,n.withMaxPoints(e,n.getMaxPoints(t)),n.withScaling(e),n.createShadowDom(r,e)}):(this.withMaxPoints(e,this.getMaxPoints(data)),this.withScaling(e),this.createShadowDom(r,e))}},{key:"disconnectedCallback",value:function(){}},{key:"createShadowDom",value:function(t,n){var e='\n      <style type="text/css">\n      .line-chart {\n        width: '.concat(n.width,"px;\n        height: ").concat(n.height,"px;\n        position: relative;\n      }\n\n      .y-axis {\n        height: 100%;\n        line-height: 0;\n        position: absolute;\n        width: 100%;\n      }\n\n      .x-axis {\n        width: calc(100% - 25px);\n        display: flex;\n        justify-content: flex-end;\n        position: absolute;\n        padding-left: 25px;\n        bottom: -25px\n      }\n\n      .line-chart svg {\n        padding-left: 25px;\n        width: calc(100% - 25px);\n        height: 100%;\n        overflow: visible;\n      }\n      \n      .line-chart polyline {\n        stroke-width: 4;\n        stroke-dasharray: ").concat(2*n.width,"px;\n        stroke-dashoffset: ").concat(2*n.width,"px;\n        animation: animation 1s forwards;\n      }\n      \n      @keyframes animation {\n        to {\n          stroke-dashoffset: 0;\n        }\n      }\n\n      .legend {\n        display: flex;\n        justify-content: flex-end;\n        flex-wrap: wrap;\n        margin-top: 40px;\n        user-select: none;\n      }\n\n      .name-item {\n          display: inline-flex;\n          align-items: center;\n          margin-bottom: 5px;\n          margin-left: 8px;\n          white-space: nowrap;\n          padding: 0 3px;\n      }\n\n      .square {\n        border: 1px solid;\n        width: 10px;\n        height: 10px;\n        margin-right: 10px;\n      }\n      </style>");t.innerHTML=e+this.getHtml(n),this.setAttribute("connected",!0)}},{key:"getAttributes",value:function(t){var n={};return n.data=JSON.parse(t.getAttribute("data")),n.source=t.getAttribute("source"),n.height=parseInt(t.getAttribute("height"))||200,n.width=parseInt(t.getAttribute("width"))||200,n.unitX=t.getAttribute("unit-x")||"unit",n.unitY=t.getAttribute("unit-y")||"unit",n}},{key:"withMaxPoints",value:function(t,n){t.maxYPoints=n.maxYPoints,t.maxYPoint=Math.max.apply(Math,_toConsumableArray(n.maxYPoints)),t.maxXPoint=Math.max.apply(Math,_toConsumableArray(n.maxXPoints))}},{key:"withScaling",value:function(t){t.scalingX=parseInt((t.width-25)/t.maxXPoint)||1,t.scalingY=parseInt(t.height/t.maxYPoint)||1}},{key:"getMaxPoints",value:function(t){var r=[],o=[];return t.map(function(t){return t.graph}).forEach(function(t){var n=Math.max.apply(Math,_toConsumableArray(t.map(function(t){return t[1]}))),e=Math.max.apply(Math,_toConsumableArray(t.map(function(t){return t[0]})));o.push(n),r.push(e)}),{maxXPoints:r,maxYPoints:o}}},{key:"getHtml",value:function(e){var r="",o="";return e.data.forEach(function(t,n){o+='<div class="name-item"><div class="square" style="background:'.concat(t.color,"; border-color: ").concat(t.color,'"></div>').concat(t.name,"</div><br/>"),r+='<polyline fill="none" stroke="'.concat(t.color,'"\n        points="').concat(t.graph.map(function(t){return"".concat(t[0]*e.scalingX,",").concat(e.height-t[1]*e.scalingY," ")}).join(""),'" />')}),'\n      <div class="line-chart">\n        <div class="y-axis">\n          <div style="position: absolute; bottom: 0">0</div>\n          '.concat(e.maxYPoints.map(function(t){return'<div style="position: absolute; bottom: '.concat(t*e.scalingY,'px">').concat(t," ").concat(t===e.maxYPoint?e.unitY:"","</div>")}).join(""),"\n        </div>\n        <svg>\n          ").concat(r,'\n        </svg>\n        <div class="x-axis">\n          <div>').concat(e.maxXPoint," ").concat(e.unitX,'</div>\n        </div>\n      </div>\n      <div class="legend">').concat(o,"</div>\n      ")}}],[{key:"tag",get:function(){return"line-chart"}}]),n}();window.customElements.define("line-chart",LineChart);
