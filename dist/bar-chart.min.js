"use strict";function _typeof(t){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function _classCallCheck(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,n){for(var e=0;e<n.length;e++){var r=n[e];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function _createClass(t,n,e){return n&&_defineProperties(t.prototype,n),e&&_defineProperties(t,e),t}function _inherits(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(n&&n.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),n&&_setPrototypeOf(t,n)}function _createSuper(e){var r=_isNativeReflectConstruct();return function(){var t,n=_getPrototypeOf(e);return _possibleConstructorReturn(this,r?(t=_getPrototypeOf(this).constructor,Reflect.construct(n,arguments,t)):n.apply(this,arguments))}}function _possibleConstructorReturn(t,n){return!n||"object"!==_typeof(n)&&"function"!=typeof n?_assertThisInitialized(t):n}function _assertThisInitialized(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function _wrapNativeSuper(t){var e="function"==typeof Map?new Map:void 0;return(_wrapNativeSuper=function(t){if(null===t||!_isNativeFunction(t))return t;if("function"!=typeof t)throw new TypeError("Super expression must either be null or a function");if(void 0!==e){if(e.has(t))return e.get(t);e.set(t,n)}function n(){return _construct(t,arguments,_getPrototypeOf(this).constructor)}return n.prototype=Object.create(t.prototype,{constructor:{value:n,enumerable:!1,writable:!0,configurable:!0}}),_setPrototypeOf(n,t)})(t)}function _construct(t,n,e){return(_construct=_isNativeReflectConstruct()?Reflect.construct:function(t,n,e){var r=[null];r.push.apply(r,n);var i=new(Function.bind.apply(t,r));return e&&_setPrototypeOf(i,e.prototype),i}).apply(null,arguments)}function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(t){return!1}}function _isNativeFunction(t){return-1!==Function.toString.call(t).indexOf("[native code]")}function _setPrototypeOf(t,n){return(_setPrototypeOf=Object.setPrototypeOf||function(t,n){return t.__proto__=n,t})(t,n)}function _getPrototypeOf(t){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var BarChart=function(){_inherits(n,_wrapNativeSuper(HTMLElement));var t=_createSuper(n);function n(){return _classCallCheck(this,n),t.apply(this,arguments)}return _createClass(n,[{key:"connectedCallback",value:function(){var n=this,e=this.attachShadow({mode:"open"}),r=this.getAttributes(this);r.source?fetch(r.source).then(function(t){return t.json()}).then(function(t){r.data=t,n.createShadowDom(e,r)}):this.createShadowDom(e,r)}},{key:"disconnectedCallback",value:function(){}},{key:"createShadowDom",value:function(t,n){var e='\n        <style type="text/css">\n        @keyframes animate-height {\n            0% {\n              height: 0;\n            }\n            100% {\n              visibility: visible;\n            }\n        }\n\n        .bar-chart-data {\n            display: flex;\n            width: '.concat(n.width,"px;\n            height: ").concat(n.height,"px;\n        }\n\n        @media screen and (max-width: 600px) {\n            #bar-chart {\n                display: block;\n            }\n\n            .legend {\n                margin-left: 0 !important;\n            }\n        }\n\n        .chart-data {\n            display: flex;\n            justify-content: space-between;\n            align-items: flex-end;\n            width: 100%;\n            height: 100%;\n        }\n\n        .bar-group {\n            position: relative;\n            display: flex;\n            justify-content: space-between;\n            align-items: flex-end;\n            height: 100%;\n        }\n\n        .bar-group:only-child {\n            width: 100%;\n        }\n\n        .bar-group-name {\n            position: absolute;\n            top: calc(100% + 10px);\n            line-height: 10px;\n            left: 50%;\n            transform: translateX(-50%);\n        }\n\n        .bar {\n            animation: animate-height;\n            animation-timing-function: cubic-bezier(.35,.95,.67,.99);\n            animation-duration: .8s;\n            animation-fill-mode: forwards;\n            height: 0;\n            width: ").concat(n.barWidth,"px;\n        }\n\n        .legend {\n            display: flex;\n            justify-content: flex-end;\n            flex-wrap: wrap;\n            padding-top: 30px;\n            user-select: none;\n            max-width: ").concat(n.width,"px;\n        }\n\n        .name-item {\n            display: inline-flex;\n            align-items: center;\n            white-space: nowrap;\n            margin-left: 8px;\n            padding: 0 3px;\n        }\n\n        .square {\n            border: 1px solid;\n            width: 10px;\n            height: 10px;\n            margin-right: 10px;\n        }\n\n        .y-axis {\n            display: flex;\n            flex-direction: column;\n            justify-content: space-between;\n            align-items: center;\n            height: 100%;\n            margin-right: 15px;\n            line-height: 0;\n        }\n        </style>");t.innerHTML=e+this.getHtml(n.data,n.unit),this.setAttribute("connected",!0)}},{key:"getAttributes",value:function(t){var n={};return n.data=JSON.parse(t.getAttribute("data")),n.source=t.getAttribute("source"),n.barWidth=parseInt(t.getAttribute("bar-width"))||20,n.height=parseInt(t.getAttribute("height"))||200,n.width=parseInt(t.getAttribute("width"))||200,n.unit=t.getAttribute("unit")||"",n}},{key:"getMaxAmount",value:function(t){var n=0;return t.forEach(function(t){t.group.forEach(function(t){t.amount>n&&(n=t.amount)})}),n}},{key:"getBarHeight",value:function(t,n){return"".concat(100/t*n,"%")}},{key:"getHtml",value:function(t,n){var e=this,r="",i=[],o=this.getMaxAmount(t);return'\n        <div id="bar-chart">\n            <div class="bar-chart-data">\n                <div class="y-axis">\n                    <div>'.concat(o,"</div>\n                    <div>").concat(parseInt(o/2),'</div>\n                    <div>0</div>\n                </div>\n                <div class="chart-data">\n                    ').concat(t.map(function(t){return'<div class="bar-group">\n                        '.concat(t.group.map(function(t){return i.includes(t.name)||(i.push(t.name),r+='<div class="name-item"><div class="square" style="background:'.concat(t.color,"; border-color: ").concat(t.color,'"></div>').concat(t.name,"</div><br/>")),'<div class="bar" title="'.concat(t.name," ").concat(t.amount," ").concat(n,'" style="height: ').concat(e.getBarHeight(o,t.amount),"; background: ").concat(t.color,';"></div>')}).join(""),'\n                        <div class="bar-group-name">').concat(t.name,"</div>\n                        </div>")}).join(""),'\n                </div>\n            </div>\n            <div class="legend">').concat(r,"</div>\n        </div> \n        ")}}],[{key:"tag",get:function(){return"bar-chart"}}]),n}();window.customElements.define("bar-chart",BarChart);
